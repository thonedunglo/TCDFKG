{
  "schema_version": "swat-kg.v0.1",
  "plant": {
    "id": "SWaT-Plant",
    "name": "Secure Water Treatment (SWaT)",
    "stages": [
      {
        "id": "P1",
        "name": "Raw Water Intake",
        "units": [
          {
            "id": "P1.U1",
            "type": "tank",
            "components": [
              {
                "id": "P1.TK.RWT",
                "name": "Raw Water Tank",
                "type": "tank"
              }
            ],
            "sensors": [
              {
                "id": "LIT-101",
                "type": "level",
                "feature_type": "level_mm",
                "unit": "mm"
              },
              {
                "id": "FIT-101",
                "type": "flow",
                "feature_type": "flow_lpm",
                "unit": "L/min"
              }
            ],
            "actuators": [
              {
                "id": "MV-101",
                "type": "motorized_valve",
                "state": "CLOSED|OPEN"
              },
              {
                "id": "P-101",
                "type": "pump",
                "state": "OFF|ON"
              },
              {
                "id": "P-102",
                "type": "pump_backup",
                "state": "OFF|ON"
              }
            ]
          }
        ],
        "procedures": [
          {
            "id": "P1.FillCycle",
            "name": "Fill Raw Tank",
            "steps": [
              {
                "id": "P1.S1",
                "name": "Open inlet valve",
                "inputs": [],
                "outputs": [
                  "MV-101:OPEN"
                ]
              },
              {
                "id": "P1.S2",
                "name": "Start pump to P2 when level OK",
                "inputs": [
                  "LIT-101>=LL_OK"
                ],
                "outputs": [
                  "P-101:ON"
                ]
              }
            ]
          }
        ]
      },
      {
        "id": "P2",
        "name": "Pre-treatment (Chemical Dosing)",
        "units": [
          {
            "id": "P2.U1",
            "type": "dosing_station",
            "components": [
              {
                "id": "P2.DS.SKID1",
                "name": "Chemical Dosing Skid",
                "type": "skid"
              }
            ],
            "sensors": [
              {
                "id": "AIT-201",
                "type": "conductivity",
                "feature_type": "cond_uS_cm",
                "unit": "uS/cm"
              },
              {
                "id": "AIT-202",
                "type": "ph",
                "feature_type": "ph",
                "unit": "pH"
              },
              {
                "id": "AIT-203",
                "type": "orp",
                "feature_type": "orp_mV",
                "unit": "mV"
              },
              {
                "id": "FIT-201",
                "type": "flow",
                "feature_type": "flow_lpm",
                "unit": "L/min"
              }
            ],
            "actuators": [
              {
                "id": "MV-201",
                "type": "motorized_valve",
                "state": "CLOSED|OPEN"
              },
              {
                "id": "P-201",
                "type": "pump_dosing",
                "state": "OFF|ON"
              },
              {
                "id": "P-202",
                "type": "pump_dosing_backup",
                "state": "OFF|ON"
              },
              {
                "id": "P-203",
                "type": "pump_dosing",
                "state": "OFF|ON"
              },
              {
                "id": "P-204",
                "type": "pump_dosing_backup",
                "state": "OFF|ON"
              },
              {
                "id": "P-205",
                "type": "pump_dosing",
                "state": "OFF|ON"
              },
              {
                "id": "P-206",
                "type": "pump_dosing_backup",
                "state": "OFF|ON"
              }
            ]
          }
        ],
        "procedures": [
          {
            "id": "P2.DosingCycle",
            "name": "Chemical Dosing Control",
            "steps": [
              {
                "id": "P2.S1",
                "name": "Open flow to UF feed",
                "inputs": [],
                "outputs": [
                  "MV-201:OPEN"
                ]
              },
              {
                "id": "P2.S2",
                "name": "Adjust NaCl dosing by conductivity",
                "inputs": [
                  "AIT-201 outside_spec"
                ],
                "outputs": [
                  "P-201:ON"
                ]
              },
              {
                "id": "P2.S3",
                "name": "Adjust HCl dosing by pH",
                "inputs": [
                  "AIT-202 outside_spec"
                ],
                "outputs": [
                  "P-203:ON"
                ]
              },
              {
                "id": "P2.S4",
                "name": "Adjust NaOCl dosing by ORP",
                "inputs": [
                  "AIT-203 outside_spec"
                ],
                "outputs": [
                  "P-205:ON"
                ]
              }
            ]
          }
        ]
      },
      {
        "id": "P3",
        "name": "Ultrafiltration (UF)",
        "units": [
          {
            "id": "P3.U1",
            "type": "uf_module",
            "components": [
              {
                "id": "P3.UF.MOD1",
                "name": "UF Membrane Module",
                "type": "membrane"
              }
            ],
            "sensors": [
              {
                "id": "LIT-301",
                "type": "level",
                "feature_type": "level_mm",
                "unit": "mm"
              },
              {
                "id": "FIT-301",
                "type": "flow",
                "feature_type": "flow_lpm",
                "unit": "L/min"
              },
              {
                "id": "DPIT-301",
                "type": "dp",
                "feature_type": "dp_bar",
                "unit": "bar"
              }
            ],
            "actuators": [
              {
                "id": "P-302",
                "type": "pump",
                "state": "OFF|ON"
              },
              {
                "id": "MV-301",
                "type": "motorized_valve",
                "state": "CLOSED|OPEN"
              },
              {
                "id": "MV-302",
                "type": "motorized_valve",
                "state": "CLOSED|OPEN"
              },
              {
                "id": "MV-303",
                "type": "motorized_valve",
                "state": "CLOSED|OPEN"
              },
              {
                "id": "MV-304",
                "type": "motorized_valve",
                "state": "CLOSED|OPEN"
              }
            ]
          }
        ],
        "procedures": [
          {
            "id": "P3.FilterCycle",
            "name": "UF Filter Cycle",
            "steps": [
              {
                "id": "P3.S1",
                "name": "Start UF feed",
                "inputs": [
                  "LIT-301>=LL_OK"
                ],
                "outputs": [
                  "P-302:ON",
                  "MV-302:OPEN"
                ]
              },
              {
                "id": "P3.S2",
                "name": "Backwash if ΔP high",
                "inputs": [
                  "DPIT-301>DP_HI"
                ],
                "outputs": [
                  "MV-301:OPEN",
                  "MV-303:OPEN",
                  "MV-304:OPEN"
                ]
              }
            ]
          }
        ]
      },
      {
        "id": "P4",
        "name": "Dechlorination (UV)",
        "units": [
          {
            "id": "P4.U1",
            "type": "uv_module",
            "components": [
              {
                "id": "P4.UV.MOD1",
                "name": "UV Dechlorination Unit",
                "type": "uv_module"
              },
              {
                "id": "P4.TK.ROFEED",
                "name": "RO Feed Tank",
                "type": "tank"
              }
            ],
            "sensors": [
              {
                "id": "AIT-401",
                "type": "hardness",
                "feature_type": "hardness_mgL",
                "unit": "mg/L"
              },
              {
                "id": "AIT-402",
                "type": "orp",
                "feature_type": "orp_mV",
                "unit": "mV"
              },
              {
                "id": "FIT-401",
                "type": "flow",
                "feature_type": "flow_lpm",
                "unit": "L/min"
              },
              {
                "id": "LIT-401",
                "type": "level",
                "feature_type": "level_mm",
                "unit": "mm"
              }
            ],
            "actuators": [
              {
                "id": "P-401",
                "type": "pump",
                "state": "OFF|ON"
              },
              {
                "id": "P-402",
                "type": "pump",
                "state": "OFF|ON"
              },
              {
                "id": "P-403",
                "type": "pump_dosing",
                "state": "OFF|ON"
              },
              {
                "id": "P-404",
                "type": "pump_dosing_backup",
                "state": "OFF|ON"
              },
              {
                "id": "UV-401",
                "type": "uv_lamp",
                "state": "OFF|ON"
              }
            ]
          }
        ],
        "procedures": [
          {
            "id": "P4.DechlorCycle",
            "name": "UV Dechlorination",
            "steps": [
              {
                "id": "P4.S1",
                "name": "Start UV feed",
                "inputs": [
                  "LIT-401>=LL_OK"
                ],
                "outputs": [
                  "P-402:ON"
                ]
              },
              {
                "id": "P4.S2",
                "name": "Enable UV lamp",
                "inputs": [
                  "FIT-401>MIN_FLOW"
                ],
                "outputs": [
                  "UV-401:ON"
                ]
              }
            ]
          }
        ]
      },
      {
        "id": "P5",
        "name": "Reverse Osmosis (RO)",
        "units": [
          {
            "id": "P5.U1",
            "type": "ro_module",
            "components": [
              {
                "id": "P5.RO.MOD1",
                "name": "RO Membrane Module",
                "type": "membrane"
              }
            ],
            "sensors": [
              {
                "id": "AIT-501",
                "type": "ph",
                "feature_type": "ph",
                "unit": "pH"
              },
              {
                "id": "AIT-502",
                "type": "orp",
                "feature_type": "orp_mV",
                "unit": "mV"
              },
              {
                "id": "AIT-503",
                "type": "conductivity",
                "feature_type": "cond_uS_cm",
                "unit": "uS/cm"
              },
              {
                "id": "AIT-504",
                "type": "conductivity",
                "feature_type": "cond_uS_cm",
                "unit": "uS/cm"
              },
              {
                "id": "FIT-501",
                "type": "flow",
                "feature_type": "flow_lpm",
                "unit": "L/min"
              },
              {
                "id": "FIT-502",
                "type": "flow",
                "feature_type": "flow_lpm",
                "unit": "L/min"
              },
              {
                "id": "FIT-503",
                "type": "flow",
                "feature_type": "flow_lpm",
                "unit": "L/min"
              },
              {
                "id": "FIT-504",
                "type": "flow",
                "feature_type": "flow_lpm",
                "unit": "L/min"
              },
              {
                "id": "PIT-501",
                "type": "pressure",
                "feature_type": "pressure_bar",
                "unit": "bar"
              },
              {
                "id": "PIT-502",
                "type": "pressure",
                "feature_type": "pressure_bar",
                "unit": "bar"
              },
              {
                "id": "PIT-503",
                "type": "pressure",
                "feature_type": "pressure_bar",
                "unit": "bar"
              }
            ],
            "actuators": [
              {
                "id": "P-501",
                "type": "pump",
                "state": "OFF|ON"
              },
              {
                "id": "P-502",
                "type": "pump_backup",
                "state": "OFF|ON"
              }
            ]
          }
        ],
        "procedures": [
          {
            "id": "P5.ROCycle",
            "name": "RO Filtration",
            "steps": [
              {
                "id": "P5.S1",
                "name": "Start RO feed",
                "inputs": [
                  "FIT-401>MIN_FLOW"
                ],
                "outputs": [
                  "P-501:ON"
                ]
              },
              {
                "id": "P5.S2",
                "name": "Monitor pressures and flows",
                "inputs": [
                  "PIT-501 within_range",
                  "FIT-502 within_range"
                ],
                "outputs": []
              }
            ]
          }
        ]
      },
      {
        "id": "P6",
        "name": "Storage & Backwash/Recycle",
        "units": [
          {
            "id": "P6.U1",
            "type": "storage_subsystem",
            "components": [
              {
                "id": "P6.TK.STORAGE",
                "name": "Final Storage Tank",
                "type": "tank"
              },
              {
                "id": "P6.TK.BACKWASH",
                "name": "UF Backwash Tank",
                "type": "tank"
              }
            ],
            "sensors": [
              {
                "id": "FIT-601",
                "type": "flow",
                "feature_type": "flow_lpm",
                "unit": "L/min"
              }
            ],
            "actuators": [
              {
                "id": "P-601",
                "type": "pump",
                "state": "OFF|ON"
              },
              {
                "id": "P-602",
                "type": "pump",
                "state": "OFF|ON"
              },
              {
                "id": "P-603",
                "type": "pump",
                "state": "OFF|ON"
              }
            ]
          }
        ],
        "procedures": [
          {
            "id": "P6.RecycleBackwash",
            "name": "Recycle / Backwash Handling",
            "steps": [
              {
                "id": "P6.S1",
                "name": "Recycle permeate to raw tank when required",
                "inputs": [
                  "storage_high"
                ],
                "outputs": [
                  "P-601:ON"
                ]
              },
              {
                "id": "P6.S2",
                "name": "Run UF backwash pump",
                "inputs": [
                  "backwash_cycle_active"
                ],
                "outputs": [
                  "P-602:ON"
                ]
              }
            ]
          }
        ]
      }
    ]
  },
  "control_layer": {
    "assets": [
      {
        "id": "PLC-P1",
        "type": "PLC",
        "stage_ref": "P1"
      },
      {
        "id": "PLC-P2",
        "type": "PLC",
        "stage_ref": "P2"
      },
      {
        "id": "PLC-P3",
        "type": "PLC",
        "stage_ref": "P3"
      },
      {
        "id": "PLC-P4",
        "type": "PLC",
        "stage_ref": "P4"
      },
      {
        "id": "PLC-P5",
        "type": "PLC",
        "stage_ref": "P5"
      },
      {
        "id": "PLC-P6",
        "type": "PLC",
        "stage_ref": "P6"
      },
      {
        "id": "SCADA-1",
        "type": "SCADA"
      },
      {
        "id": "HMI-1",
        "type": "HMI"
      },
      {
        "id": "Historian-1",
        "type": "Historian"
      }
    ],
    "network": [
      {
        "id": "NET-L1",
        "level": 1,
        "topology": "star",
        "connects": [
          "SCADA-1",
          "PLC-P1",
          "PLC-P2",
          "PLC-P3",
          "PLC-P4",
          "PLC-P5",
          "PLC-P6"
        ]
      },
      {
        "id": "NET-L0-P1",
        "level": 0,
        "topology": "ring",
        "connects": [
          "PLC-P1",
          "LIT-101",
          "FIT-101",
          "P-101",
          "P-102",
          "MV-101"
        ]
      },
      {
        "id": "NET-L0-P2",
        "level": 0,
        "topology": "ring",
        "connects": [
          "PLC-P2",
          "AIT-201",
          "AIT-202",
          "AIT-203",
          "FIT-201",
          "MV-201",
          "P-201",
          "P-202",
          "P-203",
          "P-204",
          "P-205",
          "P-206"
        ]
      },
      {
        "id": "NET-L0-P3",
        "level": 0,
        "topology": "ring",
        "connects": [
          "PLC-P3",
          "LIT-301",
          "FIT-301",
          "DPIT-301",
          "P-302",
          "MV-301",
          "MV-302",
          "MV-303",
          "MV-304"
        ]
      },
      {
        "id": "NET-L0-P4",
        "level": 0,
        "topology": "ring",
        "connects": [
          "PLC-P4",
          "LIT-401",
          "FIT-401",
          "AIT-401",
          "AIT-402",
          "P-401",
          "P-402",
          "P-403",
          "P-404",
          "UV-401"
        ]
      },
      {
        "id": "NET-L0-P5",
        "level": 0,
        "topology": "ring",
        "connects": [
          "PLC-P5",
          "AIT-501",
          "AIT-502",
          "AIT-503",
          "AIT-504",
          "FIT-501",
          "FIT-502",
          "FIT-503",
          "FIT-504",
          "PIT-501",
          "PIT-502",
          "PIT-503",
          "P-501",
          "P-502"
        ]
      },
      {
        "id": "NET-L0-P6",
        "level": 0,
        "topology": "ring",
        "connects": [
          "PLC-P6",
          "FIT-601",
          "P-601",
          "P-602",
          "P-603"
        ]
      }
    ],
    "scada_tags": [
      {
        "tag": "P1.LIT101",
        "binds": "LIT-101"
      },
      {
        "tag": "P1.FIT101",
        "binds": "FIT-101"
      },
      {
        "tag": "P1.MV101.CMD",
        "binds": "MV-101"
      },
      {
        "tag": "P1.P101.CMD",
        "binds": "P-101"
      },
      {
        "tag": "P2.AIT201",
        "binds": "AIT-201"
      },
      {
        "tag": "P2.AIT202",
        "binds": "AIT-202"
      },
      {
        "tag": "P2.AIT203",
        "binds": "AIT-203"
      },
      {
        "tag": "P2.FIT201",
        "binds": "FIT-201"
      },
      {
        "tag": "P2.MV201.CMD",
        "binds": "MV-201"
      },
      {
        "tag": "P2.P201.CMD",
        "binds": "P-201"
      },
      {
        "tag": "P2.P203.CMD",
        "binds": "P-203"
      },
      {
        "tag": "P2.P205.CMD",
        "binds": "P-205"
      },
      {
        "tag": "P3.LIT301",
        "binds": "LIT-301"
      },
      {
        "tag": "P3.DPIT301",
        "binds": "DPIT-301"
      },
      {
        "tag": "P3.P302.CMD",
        "binds": "P-302"
      },
      {
        "tag": "P4.LIT401",
        "binds": "LIT-401"
      },
      {
        "tag": "P4.FIT401",
        "binds": "FIT-401"
      },
      {
        "tag": "P4.UV401.CMD",
        "binds": "UV-401"
      },
      {
        "tag": "P4.P402.CMD",
        "binds": "P-402"
      },
      {
        "tag": "P5.PIT501",
        "binds": "PIT-501"
      },
      {
        "tag": "P5.FIT501",
        "binds": "FIT-501"
      },
      {
        "tag": "P5.FIT502",
        "binds": "FIT-502"
      },
      {
        "tag": "P5.P501.CMD",
        "binds": "P-501"
      },
      {
        "tag": "P6.FIT601",
        "binds": "FIT-601"
      },
      {
        "tag": "P6.P601.CMD",
        "binds": "P-601"
      },
      {
        "tag": "P6.P602.CMD",
        "binds": "P-602"
      }
    ]
  },
  "feature_types": [
    {
      "id": "level_mm",
      "name": "Tank Level",
      "unit": "mm",
      "range": [
        0,
        1500
      ]
    },
    {
      "id": "flow_lpm",
      "name": "Flow Rate",
      "unit": "L/min"
    },
    {
      "id": "dp_bar",
      "name": "Differential Pressure",
      "unit": "bar"
    },
    {
      "id": "pressure_bar",
      "name": "Pressure",
      "unit": "bar"
    },
    {
      "id": "ph",
      "name": "Acidity (pH)",
      "unit": "pH",
      "range": [
        0,
        14
      ]
    },
    {
      "id": "orp_mV",
      "name": "Oxidation-Reduction Potential",
      "unit": "mV"
    },
    {
      "id": "cond_uS_cm",
      "name": "Conductivity",
      "unit": "uS/cm"
    },
    {
      "id": "hardness_mgL",
      "name": "Water Hardness",
      "unit": "mg/L"
    }
  ],
  "rules": [
    {
      "id": "R.P1.LowLevelPumpProtect",
      "scope": "stage",
      "applies_to": "P1",
      "logic": [
        {
          "sensor": "LIT-101",
          "feature_type": "level_mm",
          "op": "<=",
          "value": 300
        }
      ],
      "on_true": {
        "actions": [
          {
            "actuator": "P-101",
            "set": "OFF"
          }
        ],
        "emit_event": "EV.P1.LowLevelTrip"
      }
    },
    {
      "id": "R.P3.HighDPBackwash",
      "scope": "stage",
      "applies_to": "P3",
      "logic": [
        {
          "sensor": "DPIT-301",
          "feature_type": "dp_bar",
          "op": ">",
          "value": 0.8
        }
      ],
      "on_true": {
        "actions": [
          {
            "actuator": "MV-301",
            "set": "OPEN"
          },
          {
            "actuator": "MV-303",
            "set": "OPEN"
          },
          {
            "actuator": "MV-304",
            "set": "OPEN"
          }
        ],
        "emit_event": "EV.P3.BackwashStart"
      }
    },
    {
      "id": "R.P3.SafeStart",
      "scope": "stage",
      "applies_to": "P3",
      "logic": [
        {
          "sensor": "LIT-301",
          "feature_type": "level_mm",
          "op": ">=",
          "value": 500
        }
      ],
      "on_true": {
        "actions": [
          {
            "actuator": "P-302",
            "set": "ON"
          }
        ]
      }
    }
  ],
  "events": [
    {
      "id": "EV.P1.LowLevelTrip",
      "category": "safety",
      "severity": "critical",
      "description": "Raw tank level low; stop P-101 to protect pump"
    },
    {
      "id": "EV.P3.BackwashStart",
      "category": "maintenance",
      "severity": "minor",
      "description": "ΔP high on UF; initiate backwash cycle"
    }
  ],
  "attacks": [
    {
      "id": "A1.SSSP.LIT101-Overflow",
      "type": "SSSP",
      "stage": "P1",
      "points": [
        "LIT-101",
        "P-101"
      ],
      "intent": "Overflow raw tank by spoofing level high while stopping outflow pump",
      "labels": {
        "start": "2015-12-29T18:30:00",
        "end": "2015-12-29T18:42:00"
      },
      "spoof": [
        {
          "tag": "P1.LIT101",
          "value": 700
        }
      ],
      "expected_effects": [
        "EV.P1.LowLevelTrip:false",
        "Level actually rising"
      ]
    },
    {
      "id": "A2.SSSP.LIT301-Underflow",
      "type": "SSSP",
      "stage": "P3",
      "points": [
        "LIT-301",
        "P-302"
      ],
      "intent": "Underflow UF feed tank and risk pump damage by spoofing level high",
      "labels": {
        "start": "2015-12-29T12:08:00",
        "end": "2015-12-29T12:15:00"
      },
      "spoof": [
        {
          "tag": "P3.LIT301",
          "value": 1100
        }
      ],
      "expected_effects": [
        "P-302:ON while true level falls",
        "Plant throughput degrades"
      ]
    }
  ],
  "data_stream": {
    "sampling_period_sec": 1,
    "modes": [
      "normal",
      "attack"
    ]
  }
}